S.m_P.rett_extremes = read.csv("S.m-P.rett extremes.csv")
S.m_P.snee = read.csv("S.m-P.snee.csv")
P.rett_varied_primary = read.csv("Varied primary S.m-P.rett.csv")
P.snee_varied_primary = read.csv("Varied primary S.m-P.snee.csv")
E.fae_P.rett$primary <- ordered(E.fae_P.rett$primary, levels = c("PBS", "E.fae"))
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
S.m_P.rett_no_extremes$primary <- ordered(S.m_P.rett_no_extremes$primary, levels = c("PBS", "S.m"))
table(S.m_P.rett_no_extremes$primary, S.m_P.rett_no_extremes$secondary_dose)
S.m_bacterial_load$primary <- ordered(S.m_bacterial_load$primary, levels = c("PBS", "S.m"))
table(S.m_bacterial_load$primary, S.m_bacterial_load$secondary_dose)
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
E.fae_P.rett$primary <- ordered(E.fae_P.rett$primary, levels = c("PBS", "E.fae"))
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
png(file="S.m_P.rett_no_extremes_bacterial_load.png",width=1200,height=900,res=130)
ggplot(S.m_P.rett_no_extremes, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
png(file="S.m_P.rett_no_extremes_bacterial_load.png",width=1200,height=900,res=130)
ggplot(S.m_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
table(S.m_P.rett_no_extremes$primary, S.m_P.rett_no_extremes$secondary_dose)
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
S.m_P.rett_no_extremes$primary <- ordered(S.m_P.rett_no_extremes$primary, levels = c("PBS", "S.m"))
table(S.m_P.rett_no_extremes$primary, S.m_P.rett_no_extremes$secondary_dose)
S.m_bacterial_load$primary <- ordered(S.m_bacterial_load$primary, levels = c("PBS", "S.m"))
table(S.m_bacterial_load$primary, S.m_bacterial_load$secondary_dose)
#BACTERIAL LOAD
png(file="S.m_P.rett_no_extremes_bacterial_load.png",width=1200,height=900,res=130)
ggplot(S.m_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="S.m_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(S.m_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
table(S.m_bacterial_load$primary, S.m_bacterial_load$secondary_dose)
S.m_bacterial_load = read.csv("S.m bacterial load data.csv")
S.m_bacterial_load$primary <- ordered(S.m_bacterial_load$primary, levels = c("PBS", "S.m"))
table(S.m_bacterial_load$primary, S.m_bacterial_load$secondary_dose)
#BACTERIAL LOAD
png(file="S.m_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(S.m_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("#055df5", "gray")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="S.m_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(S.m_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
table(S.m_bacterial_load$primary, S.m_bacterial_load$secondary_dose)
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
knitr::opts_chunk$set(echo = TRUE)
library(survival)
library(RColorBrewer)
library(ggplot2)
library(rlang)
library(agricolae)
rm(list=ls()) #removes all old variables
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
S.m_P.rett_no_extremes = read.csv("S.m-P.rett no extremes.csv")
S.m_bacterial_load = read.csv("S.m bacterial load data.csv")
S.m_P.rett_extremes = read.csv("S.m-P.rett extremes.csv")
S.m_P.snee = read.csv("S.m-P.snee.csv")
P.rett_varied_primary = read.csv("Varied primary S.m-P.rett.csv")
P.snee_varied_primary = read.csv("Varied primary S.m-P.snee.csv")
E.fae_P.rett$primary <- ordered(E.fae_P.rett$primary, levels = c("PBS", "E.fae"))
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
E.fae_P.rett$primary <- ordered(E.fae_P.rett$primary, levels = c("PBS", "E.fae"))
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = load, fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = black), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(aes(color = "black"), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(color = "black", size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(color = c("black", "blue"), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
#scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(color = "black", size = 1.1, position=position_jitterdodge()) +
scale_fill_manual(values=c("gray", "#055df5"))
E.fae_resistance <- lm(log(load) ~ secondary_dose + primary + rep + secondary_dose:primary, data = E.fae_bacterial_load)
View(E.fae_bacterial_load)
#BACTERIAL LOAD STATISTICS
E.fae_resistance <- lm(log(load) ~ secondary_dose + primary + replicate + secondary_dose:primary, data = E.fae_bacterial_load)
anova(E.fae_resistance)
View(E.fae_bacterial_load)
table(E.fae_bacterial_load$time, E.fae_bacterial_load$secondary_dose)
#10HOUR STUFF
#BACTERIAL LOAD
E.fae_bacterial_load_10hr <- subset(E.fae_bacterial_load, time == 10)
table(E.fae_bacterial_load_10hr$time, E.fae_bacterial_load_10hr$secondary_dose)
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load_10hr, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(color = "black", size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD STATISTICS
E.fae_resistance <- lm(log(load) ~ secondary_dose + primary + replicate + secondary_dose:primary, data = E.fae_bacterial_load_10hr)
anova(E.fae_resistance)
#JUST FOR FUN
#0HOUR STUFF
#BACTERIAL LOAD
E.fae_bacterial_load_0hr <- subset(E.fae_bacterial_load, time == 0)
table(E.fae_bacterial_load_0hr$time, E.fae_bacterial_load_0hr$secondary_dose)
png(file="E.fae_P.rett_bacterial_0h_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load_0hr, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#055df5")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(color = "black", size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD STATISTICS
E.fae_resistance <- lm(log(load) ~ secondary_dose + primary + replicate + secondary_dose:primary, data = E.fae_bacterial_load_0hr)
anova(E.fae_resistance)
E.fae_resistance <- lm(log(load) ~ secondary_dose + primary + replicate + secondary_dose:primary, data = E.fae_bacterial_load_10hr)
anova(E.fae_resistance)
knitr::opts_chunk$set(echo = TRUE)
library(survival)
library(RColorBrewer)
library(ggplot2)
library(rlang)
library(agricolae)
rm(list=ls()) #removes all old variables
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
S.m_P.rett_no_extremes = read.csv("S.m-P.rett no extremes.csv")
S.m_bacterial_load = read.csv("S.m bacterial load data.csv")
S.m_P.rett_extremes = read.csv("S.m-P.rett extremes.csv")
S.m_P.snee = read.csv("S.m-P.snee.csv")
P.rett_varied_primary = read.csv("Varied primary S.m-P.rett.csv")
P.snee_varied_primary = read.csv("Varied primary S.m-P.snee.csv")
P.rett_varied_primary = subset(P.rett_varied_primary, secondary == "P.rett")
table(P.rett_varied_primary$primary_dose)
P.rett_varied_primary$primary_dose <- as.factor(P.rett_varied_primary$primary_dose)
#STATISTICS
#Generate a Cox proportional Hazards model which assesses the contribution of infectious dose while controlling for replicate
table(P.rett_varied_primary$rep, P.rett_varied_primary$primary_dose)
P.rett_varied_primary_coxph <- coxph(Surv(day, status) ~ primary_dose, data = P.rett_varied_primary)
summary(P.rett_varied_primary_coxph)
anova(P.rett_varied_primary_coxph)
table(P.rett_varied_primary$rep, P.rett_varied_primary$primary_dose)
P.rett_varied_primary_coxph <- coxph(Surv(day, status) ~ primary_dose + rep + primary_dose*rep, data = P.rett_varied_primary)
summary(P.rett_varied_primary_coxph)
anova(P.rett_varied_primary_coxph)
P.rett_varied_primary_coxph <- coxph(Surv(day, status) ~ primary + primary_dose + rep + primary_dose*rep, data = P.rett_varied_primary)
summary(P.rett_varied_primary_coxph)
anova(P.rett_varied_primary_coxph)
knitr::opts_chunk$set(echo = TRUE)
library(survival)
rm(list=ls()) #removes all old variables
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
S.m_P.rett_no_extremes = read.csv("S.m-P.rett no extremes.csv")
S.m_bacterial_load = read.csv("S.m bacterial load data.csv")
S.m_P.rett_extremes = read.csv("S.m-P.rett extremes.csv")
S.m_P.snee = read.csv("S.m-P.snee.csv")
P.rett_varied_primary = read.csv("Varied primary S.m-P.rett.csv")
P.snee_varied_primary = read.csv("Varied primary S.m-P.snee.csv")
table(P.rett_varied_primary$rep, P.rett_varied_primary$primary_dose)
P.rett_varied_primary_coxph <- coxph(Surv(day, status) ~ rep + primary_dose, data = P.rett_varied_primary)
summary(P.rett_varied_primary_coxph)
anova(P.rett_varied_primary_coxph)
P.rett_varied_primary = subset(P.rett_varied_primary, secondary == "P.rett")
table(P.rett_varied_primary$primary_dose)
P.rett_varied_primary$primary_dose <- as.factor(P.rett_varied_primary$primary_dose)
table(P.rett_varied_primary$rep, P.rett_varied_primary$primary_dose)
P.rett_varied_primary_coxph <- coxph(Surv(day, status) ~ rep + primary_dose, data = P.rett_varied_primary)
summary(P.rett_varied_primary_coxph)
anova(P.rett_varied_primary_coxph)
knitr::opts_chunk$set(echo = TRUE)
library(survival)
library(RColorBrewer)
library(ggplot2)
library(rlang)
library(agricolae)
rm(list=ls()) #removes all old variables
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
S.m_P.rett_no_extremes = read.csv("S.m-P.rett no extremes.csv")
S.m_bacterial_load = read.csv("S.m bacterial load data.csv")
S.m_P.rett_extremes = read.csv("S.m-P.rett extremes.csv")
S.m_P.snee = read.csv("S.m-P.snee.csv")
P.rett_varied_primary = read.csv("Varied primary S.m-P.rett.csv")
P.snee_varied_primary = read.csv("Varied primary S.m-P.snee.csv")
table(S.m_P.rett_no_extremes$date, S.m_P.rett_no_extremes$secondary_dose)
#S.m_P.rett_no_extremes 7/10/18 is the problematic one - need to delete
#S.m_P.rett_no8 <- subset(S.m_P.rett_no_extremes, date == "6/14/2019" | date == "6/17/2019" | date == "6/19/2019" | date == "6/25/2019" | date == "6/27/2019" | date == "6/28/2019" | date == "8/2/2018" | date == "8/6/2018")
#table(S.m_P.rett_no8$date, S.m_P.rett_no8$secondary_dose)
#write.csv(S.m_P.rett_no8, "S.m_P.rett no extremes.csv")
E.fae_P.rett$primary <- ordered(E.fae_P.rett$primary, levels = c("PBS", "E.fae"))
table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose)
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
table(E.fae_bacterial_load$primary, E.fae_bacterial_load$secondary_dose)
#BACTERIAL LOAD
E.fae_bacterial_load_10hr <- subset(E.fae_bacterial_load, time == 10)
table(E.fae_bacterial_load_10hr$time, E.fae_bacterial_load_10hr$secondary_dose)
png(file="E.fae_P.rett_bacterial_load.png",width=1200,height=900,res=130)
ggplot(E.fae_bacterial_load_10hr, aes(x = as.character(secondary_dose), y = log(load), fill = primary)) +
scale_fill_manual(values=c("gray", "#09b6fc")) +
geom_boxplot() +
theme_classic(base_size = 25) +
xlab("secondary dose of P. rettgeri") +
ylab("log(calculated bacterial load)") +
geom_point(color = "black", size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD STATISTICS
E.fae_resistance <- lm(log(load) ~ secondary_dose + primary + replicate + secondary_dose:primary, data = E.fae_bacterial_load_10hr)
E.fae_resistance_anova <- anova(E.fae_resistance)
E.fae_resistance_anova
table(E.fae_P.rett$Date, E.fae_P.rett$secondary_dose)
E.fae_P.rett_block1 <- subset(E.fae_P.rett, Date == "6/11/2019")
E.fae_P.rett_block2 <- subset(E.fae_P.rett, Date == "6/22/2019")
#THE GRAPH
#png(file="S.m_P.rett_no_extremes.png",width=1200,height=900,res=130)
par(mar=c(4,5,1,1)) #sets the margins around the graph so there is room for the labels
plot(survfit(Surv(E.fae_P.rett_block2$day, E.fae_P.rett_block2$status) ~ E.fae_P.rett_block2$primary + E.fae_P.rett_block2$secondary_dose), col=c("#B5E8FC",  "#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 3, 1, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
axis(2, las=2, cex.axis=1.5, lwd=5)
axis(1, cex.axis=1.5, lwd=5)
box(lwd=5)
#THE LEGEND
legend("topright",inset=0, bty="n" , c("PBS-P.rett 0.001", "PBS-P.rett 0.01", "PBS-P.rett 0.1", 'PBS-P.rett 1.0', "E.fae-P.rett 0.001", "E.fae-P.rett 0.01", "E.fae-P.rett 0.1", "E.fae-P.rett 1.0"),col=c("#B5E8FC", "#09B6FC", "#055df5", "#003694"),lty=c(3, 3, 3, 3, 1, 1, 1, 1),lwd=5, cex=1)
E.fae_P.rett_block2 <- subset(E.fae_P.rett, Date == "6/22/2018")
#THE GRAPH
#png(file="S.m_P.rett_no_extremes.png",width=1200,height=900,res=130)
par(mar=c(4,5,1,1)) #sets the margins around the graph so there is room for the labels
plot(survfit(Surv(E.fae_P.rett_block2$day, E.fae_P.rett_block2$status) ~ E.fae_P.rett_block2$primary + E.fae_P.rett_block2$secondary_dose), col=c("#B5E8FC",  "#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 3, 1, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
axis(2, las=2, cex.axis=1.5, lwd=5)
axis(1, cex.axis=1.5, lwd=5)
box(lwd=5)
#THE LEGEND
legend("topright",inset=0, bty="n" , c("PBS-P.rett 0.001", "PBS-P.rett 0.01", "PBS-P.rett 0.1", 'PBS-P.rett 1.0', "E.fae-P.rett 0.001", "E.fae-P.rett 0.01", "E.fae-P.rett 0.1", "E.fae-P.rett 1.0"),col=c("#B5E8FC", "#09B6FC", "#055df5", "#003694"),lty=c(3, 3, 3, 3, 1, 1, 1, 1),lwd=5, cex=1)
table(E.fae_P.rett$Date, E.fae_P.rett$secondary_dose)
table(E.fae_P.rett$Date, E.fae_P.rett$secondary_dose)
E.fae_P.rett_block1 <- subset(E.fae_P.rett, Date == "6/11/2019")
#THE GRAPH
#png(file="S.m_P.rett_no_extremes.png",width=1200,height=900,res=130)
par(mar=c(4,5,1,1)) #sets the margins around the graph so there is room for the labels
plot(survfit(Surv(E.fae_P.rett_block1$day, E.fae_P.rett_block1$status) ~ E.fae_P.rett_block1$primary + E.fae_P.rett_block1$secondary_dose), col=c("#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
axis(2, las=2, cex.axis=1.5, lwd=5)
axis(1, cex.axis=1.5, lwd=5)
box(lwd=5)
#THE LEGEND
legend("topright",inset=0, bty="n" , c("PBS-P.rett 0.01", "PBS-P.rett 0.1", 'PBS-P.rett 1.0', "E.fae-P.rett 0.01", "E.fae-P.rett 0.1", "E.fae-P.rett 1.0"),col=c("#09B6FC", "#055df5", "#003694"),lty=c(3, 3, 3, 1, 1, 1),lwd=5, cex=1)
table(E.fae_P.rett$Date, E.fae_P.rett$secondary_dose)
table(E.fae_P.rett_block1$Date, E.fae_P.rett_block1$dose)
table(E.fae_P.rett_block1$day, E.fae_P.rett_block1$dose)
View(E.fae_P.rett_block1)
E.fae_P.rett_block1 <- subset(E.fae_P.rett, Date == "6/11/2019")
table(E.fae_P.rett_block1$day, E.fae_P.rett_block1$dose)
table(E.fae_P.rett_block1$dose)
E.fae_P.rett_block1 <- subset(E.fae_P.rett, Date == "6/11/2019")
table(E.fae_P.rett_block1$day, E.fae_P.rett_block1$secondary_dose)
table(E.fae_P.rett_block1$primary, E.fae_P.rett_block1$secondary_dose)
table(E.fae_P.rett_block2$primary, E.fae_P.rett_block2$secondary_dose)
table(E.fae_P.rett_block1$primary, E.fae_P.rett_block1$secondary_dose)
table(E.fae_P.rett_block8$primary, E.fae_P.rett_block8$secondary_dose)
E.fae_P.rett_block8 <- subset(E.fae_P.rett, Date == "7/3/2019")
table(E.fae_P.rett_block8$primary, E.fae_P.rett_block8$secondary_dose)
plot(survfit(Surv(E.fae_P.rett_block8$day, E.fae_P.rett_block8$status) ~ E.fae_P.rett_block8$primary + E.fae_P.rett_block9$secondary_dose), col=c("#B5E8FC",  "#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 3, 1, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
plot(survfit(Surv(E.fae_P.rett_block8$day, E.fae_P.rett_block8$status) ~ E.fae_P.rett_block8$primary + E.fae_P.rett_block8$secondary_dose), col=c("#B5E8FC",  "#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 3, 1, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
table(E.fae_P.rett_block8$day, E.fae_P.rett_block8$secondary_dose)
plot(survfit(Surv(E.fae_P.rett_block8$primary, E.fae_P.rett_block8$status) ~ E.fae_P.rett_block8$primary + E.fae_P.rett_block8$secondary_dose), col=c("#B5E8FC",  "#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 3, 1, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
table(E.fae_P.rett_block8$primary, E.fae_P.rett_block8$secondary_dose)
S.m_P.rett_no_extremes$primary <- ordered(S.m_P.rett_no_extremes$primary, levels = c("PBS", "S.m"))
#table(S.m_P.rett_no_extremes$primary, S.m_P.rett_no_extremes$secondary_dose)
S.m_bacterial_load$primary <- ordered(S.m_bacterial_load$primary, levels = c("PBS", "S.m"))
#table(S.m_bacterial_load$primary, S.m_bacterial_load$secondary_dose)
#THE GRAPH
#png(file="S.m_P.rett_no_extremes.png",width=1200,height=900,res=130)
par(mar=c(4,5,1,1)) #sets the margins around the graph so there is room for the labels
plot(survfit(Surv(S.m_P.rett_no_extremes$day, S.m_P.rett_no_extremes$status) ~ S.m_P.rett_no_extremes$primary + S.m_P.rett_no_extremes$secondary_dose), col=c("#B5E8FC",  "#09B6FC", "#055df5", "#003694"), lty=c(3, 3, 3, 3, 1, 1, 1, 1), lwd=5,yaxt='n', xaxt='n', ylab="proportion alive", xlab="days post-secondary infection", cex.lab=2.5, xlim=c(0,7), xaxs='i')
axis(2, las=2, cex.axis=1.5, lwd=5)
axis(1, cex.axis=1.5, lwd=5)
box(lwd=5)
#THE LEGEND
legend("topright",inset=0, bty="n" , c("PBS-P.rett 0.01", "PBS-P.rett 0.1", "PBS-P.rett 1.0", "PBS-P.rett 2.0", "S.m-P.rett 0.01", "S.m-P.rett 0.1", "S.m-P.rett 1.0", "S.m-P.rett 2.0"),col=c("#B5E8FC", "#09B6FC", "#055df5", "#003694"),lty=c(3, 3, 3, 3, 1, 1, 1, 1),lwd=5, cex=1)
#STATISTICS
S.m_P.rett_no_extremes$secondary_dose <- as.factor(S.m_P.rett_no_extremes$secondary_dose)
S.m_P.rett_no_extremes_coxph <- coxph(Surv(day, status) ~ secondary_dose + primary + rep + primary:secondary_dose + rep:secondary_dose + rep:primary, data = S.m_P.rett_no_extremes)
summary(S.m_P.rett_no_extremes_coxph)
#anova(S.m_P.rett_no_extremes_coxph)
#DO NOT HAVE DATA IN THE RIGHT FORMAT YET - S.m_bacterial_load is a fake!
#BACTERIAL LOAD
#png(file="S.m_P.rett_bacterial_load.png",width=1200,height=900,res=130)
#ggplot(S.m_bacterial_load, aes(x = as.character(secondary_dose), y = log10_10hour, fill = primary)) +
#  scale_fill_manual(values=c("gray", "#055df5")) +
#  geom_boxplot() +
#  theme_classic(base_size = 25) +
#  xlab("secondary dose of P. rettgeri") +
#  ylab("log(calculated bacterial load)") +
#  geom_point(aes(color = primary), size = 1.1, position=position_jitterdodge())
#BACTERIAL LOAD STATISTICS
#S.m_resistance <- lm(log(load) ~ secondary_dose + primary + replicate + secondary_dose:primary, data = S.m_bacterial_load)
#S.m_resistance_anova <- anova(S.m_resistance)
#S.m_resistance_anova
E.fae_P.rett$primary <- ordered(E.fae_P.rett$primary, levels = c("PBS", "E.fae"))
E.fae_bacterial_load$primary <- ordered(E.fae_bacterial_load$primary, levels = c("PBS", "E.fae"))
#KAPLAN MEIER
#table(E.fae_P.rett$primary, E.fae_P.rett$secondary_dose) #tells you the number of flies in each condition
#png(file="E.fae-P.rett.png", width=1200, heigh=900, res=130) #determines where the graph will be saved
par(mar=c(4,5,1,1)) #sets the margins around the graph so there is room for the labels
#The graph
plot(survfit(Surv(E.fae_P.rett$day, E.fae_P.rett$status) ~ E.fae_P.rett$primary + E.fae_P.rett$secondary_dose),
col=c("#B5E8FC", "#09B6FC", "#055df5", "#0600a8"), #line color, cycles through
lty=c(3, 3, 3, 3, 1, 1, 1, 1), #line type
lwd=5, #line width
yaxt='n', #hide the y axis so I can customize it
xaxt='n', #hide the x axis so I can customize itS
ylab="proportion alive", #label for the y-axis
xlab="days post-secondary infection", #label for the x-axis
cex.lab=2.5, #font size of axis labels
xlim=c(0,7), #determines range of the x-axis
xaxs='i') #makes the data flush with the axis
#Y axis
axis(2, #left side
las=2, #perpendicular to the axis
cex.axis=1.5, #font size
lwd=5) #line width
#X axis
axis(1, #bottom of the graph
cex.axis=1.5, #font size
lwd=5) #line width
box(lwd=5)
#The legend
legend("topright", #location
bty="n", #no box around the legend
c("PBS-P.rett 0.001", "PBS-P.rett 0.01", "PBS-P.rett 0.1", 'PBS-P.rett 1.0', "E.fae-P.rett 0.001", "E.fae-P.rett 0.01", "E.fae-P.rett 0.1", "E.fae-P.rett 1.0"), #labels in the legend
col=c("#B5E8FC", "#09B6FC", "#055df5", "#0600a8"), #colors for the legend lines, cycles through
lty=c(3, 3, 3, 3, 1, 1, 1, 1), #line type for legend lines
lwd=5, #line width for legend lines
cex=1) #font size
table(E.fae_P.rett$rep, E.fae_P.rett$secondary_dose)
library(survival)
library(RColorBrewer)
library(ggplot2)
library(rlang)
library(agricolae)
rm(list=ls()) #removes all old variables
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
E.fae_bacterial_load = read.csv("E.fae bacterial load data.csv")
S.m_P.rett_no_extremes = read.csv("S.m-P.rett no extremes.csv")
S.m_bacterial_load = read.csv("S.m bacterial load data.csv")
S.m_P.rett_extremes = read.csv("S.m-P.rett extremes.csv")
S.m_P.snee = read.csv("S.m-P.snee.csv")
P.rett_varied_primary = read.csv("Varied primary S.m-P.rett.csv")
P.snee_varied_primary = read.csv("Varied primary S.m-P.snee.csv")
table(S.m_P.rett_no_extremes$date, S.m_P.rett_no_extremes$secondary_dose)
#S.m_P.rett_no_extremes 7/10/18 is the problematic one - need to delete
#S.m_P.rett_no8 <- subset(S.m_P.rett_no_extremes, date == "6/14/2019" | date == "6/17/2019" | date == "6/19/2019" | date == "6/25/2019" | date == "6/27/2019" | date == "6/28/2019" | date == "8/2/2018" | date == "8/6/2018")
#table(S.m_P.rett_no8$date, S.m_P.rett_no8$secondary_dose)
#write.csv(S.m_P.rett_no8, "S.m_P.rett no extremes.csv")
table(E.fae_P.rett$rep, E.fae_P.rett$secondary_dose)
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
getwd()
setwd("C:/Users/amw03/Documents/GitHub/Chambers_Lab/The Protective Effect of Primary Infections")
E.fae_P.rett = read.csv("E.fae-P.rett.csv")
table(E.fae_P.rett$rep, E.fae_P.rett$secondary_dose)
